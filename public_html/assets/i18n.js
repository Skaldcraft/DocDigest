// Multi-language support
const translations = {
    en: {
        tagline: "Understand official documents, fast and easy.",
        uploadFile: "Upload File",
        uploadImage: "Upload Image",
        pasteText: "Paste Text",
        dragDrop: "Drag & Drop your file here",
        or: "or",
        browseFiles: "Browse Files",
        maxSize: "PDF, DOCX, TXT (Max 10MB)",
        simplifyDocument: "Simplify Document",
        uploadImageText: "Upload an image of printed text",
        selectImage: "Select Image",
        extractSimplify: "Extract & Simplify",
        pasteHere: "Paste the official text here...",
        simplifyText: "Simplify Text",
        securePrivate: "Secure & Private",
        secureDesc: "Files are auto-deleted after processing.",
        interactiveAI: "Interactive AI",
        interactiveDesc: "Ask questions to your document.",
        multilingual: "Multilingual",
        multilingualDesc: "Works in any major language.",
        privacyPolicy: "Privacy Policy",
        uploadedSuccess: "✓ Uploaded successfully"
    },
    es: {
        tagline: "Entiende documentos oficiales, rápido y fácil.",
        uploadFile: "Subir Archivo",
        uploadImage: "Subir Imagen",
        pasteText: "Pegar Texto",
        dragDrop: "Arrastra y suelta tu archivo aquí",
        or: "o",
        browseFiles: "Buscar Archivos",
        maxSize: "PDF, DOCX, TXT (Máx 10MB)",
        simplifyDocument: "Simplificar Documento",
        uploadImageText: "Sube una imagen de texto impreso",
        selectImage: "Seleccionar Imagen",
        extractSimplify: "Extraer y Simplificar",
        pasteHere: "Pega el texto oficial aquí...",
        simplifyText: "Simplificar Texto",
        securePrivate: "Seguro y Privado",
        secureDesc: "Los archivos se eliminan automáticamente después del procesamiento.",
        interactiveAI: "IA Interactiva",
        interactiveDesc: "Haz preguntas sobre tu documento.",
        multilingual: "Multiidioma",
        multilingualDesc: "Funciona en cualquier idioma principal.",
        privacyPolicy: "Política de Privacidad",
        uploadedSuccess: "✓ Subido exitosamente"
    },
    fr: {
        tagline: "Comprenez les documents officiels, rapidement et facilement.",
        uploadFile: "Télécharger un Fichier",
        uploadImage: "Télécharger une Image",
        pasteText: "Coller du Texte",
        dragDrop: "Glissez-déposez votre fichier ici",
        or: "ou",
        browseFiles: "Parcourir les Fichiers",
        maxSize: "PDF, DOCX, TXT (Max 10Mo)",
        simplifyDocument: "Simplifier le Document",
        uploadImageText: "Téléchargez une image de texte imprimé",
        selectImage: "Sélectionner une Image",
        extractSimplify: "Extraire et Simplifier",
        pasteHere: "Collez le texte officiel ici...",
        simplifyText: "Simplifier le Texte",
        securePrivate: "Sécurisé et Privé",
        secureDesc: "Les fichiers sont automatiquement supprimés après traitement.",
        interactiveAI: "IA Interactive",
        interactiveDesc: "Posez des questions sur votre document.",
        multilingual: "Multilingue",
        multilingualDesc: "Fonctionne dans toutes les langues principales.",
        privacyPolicy: "Politique de Confidentialité",
        uploadedSuccess: "✓ Téléchargé avec succès"
    },
    de: {
        tagline: "Verstehen Sie offizielle Dokumente, schnell und einfach.",
        uploadFile: "Datei Hochladen",
        uploadImage: "Bild Hochladen",
        pasteText: "Text Einfügen",
        dragDrop: "Ziehen Sie Ihre Datei hierher",
        or: "oder",
        browseFiles: "Dateien Durchsuchen",
        maxSize: "PDF, DOCX, TXT (Max 10MB)",
        simplifyDocument: "Dokument Vereinfachen",
        uploadImageText: "Laden Sie ein Bild mit gedrucktem Text hoch",
        selectImage: "Bild Auswählen",
        extractSimplify: "Extrahieren & Vereinfachen",
        pasteHere: "Fügen Sie den offiziellen Text hier ein...",
        simplifyText: "Text Vereinfachen",
        securePrivate: "Sicher & Privat",
        secureDesc: "Dateien werden nach der Verarbeitung automatisch gelöscht.",
        interactiveAI: "Interaktive KI",
        interactiveDesc: "Stellen Sie Fragen zu Ihrem Dokument.",
        multilingual: "Mehrsprachig",
        multilingualDesc: "Funktioniert in jeder Hauptsprache.",
        privacyPolicy: "Datenschutzrichtlinie",
        uploadedSuccess: "✓ Erfolgreich hochgeladen"
    },
    it: {
        tagline: "Comprendi i documenti ufficiali, velocemente e facilmente.",
        uploadFile: "Carica File",
        uploadImage: "Carica Immagine",
        pasteText: "Incolla Testo",
        dragDrop: "Trascina e rilascia il tuo file qui",
        or: "o",
        browseFiles: "Sfoglia File",
        maxSize: "PDF, DOCX, TXT (Max 10MB)",
        simplifyDocument: "Semplifica Documento",
        uploadImageText: "Carica un'immagine di testo stampato",
        selectImage: "Seleziona Immagine",
        extractSimplify: "Estrai e Semplifica",
        pasteHere: "Incolla il testo ufficiale qui...",
        simplifyText: "Semplifica Testo",
        securePrivate: "Sicuro e Privato",
        secureDesc: "I file vengono eliminati automaticamente dopo l'elaborazione.",
        interactiveAI: "IA Interattiva",
        interactiveDesc: "Fai domande sul tuo documento.",
        multilingual: "Multilingue",
        multilingualDesc: "Funziona in qualsiasi lingua principale.",
        privacyPolicy: "Informativa sulla Privacy",
        uploadedSuccess: "✓ Caricato con successo"
    },
    cn: {
        tagline: "快速轻松地理解官方文件。",
        uploadFile: "上传文件",
        uploadImage: "上传图片",
        pasteText: "粘贴文本",
        dragDrop: "将文件拖放到此处",
        or: "或",
        browseFiles: "浏览文件",
        maxSize: "PDF, DOCX, TXT (最大10MB)",
        simplifyDocument: "简化文档",
        uploadImageText: "上传打印文本的图片",
        selectImage: "选择图片",
        extractSimplify: "提取并简化",
        pasteHere: "在此粘贴官方文本...",
        simplifyText: "简化文本",
        securePrivate: "安全私密",
        secureDesc: "文件在处理后自动删除。",
        interactiveAI: "互动AI",
        interactiveDesc: "向您的文档提问。",
        multilingual: "多语言",
        multilingualDesc: "适用于任何主要语言。",
        privacyPolicy: "隐私政策",
        uploadedSuccess: "✓ 上传成功"
    }
};

// Language switcher
let currentLang = 'en';

function switchLanguage(lang) {
    currentLang = lang;
    const t = translations[lang];

    // Update all translatable elements
    document.querySelector('.tagline').textContent = t.tagline;

    // Tab buttons
    const tabs = document.querySelectorAll('.tab-btn span:last-child');
    if (tabs[0]) tabs[0].textContent = t.uploadFile;
    if (tabs[1]) tabs[1].textContent = t.uploadImage;
    if (tabs[2]) tabs[2].textContent = t.pasteText;

    // File upload section
    const dragDropText = document.querySelector('#fileDropZone p');
    if (dragDropText && !dragDropText.innerHTML.includes('✓')) {
        dragDropText.textContent = t.dragDrop;
    }

    const orSpan = document.querySelector('#fileDropZone span');
    if (orSpan) orSpan.textContent = t.or;

    const browseLabel = document.querySelector('label[for="fileInput"]');
    if (browseLabel) browseLabel.textContent = t.browseFiles;

    const maxSizeText = document.querySelector('#fileDropZone .small-text');
    if (maxSizeText) maxSizeText.textContent = t.maxSize;

    const simplifyBtn = document.querySelector('#fileForm button[type="submit"]');
    if (simplifyBtn) simplifyBtn.textContent = t.simplifyDocument;

    // Image upload section
    const imageDropText = document.querySelector('#imageDropZone p');
    if (imageDropText) imageDropText.textContent = t.uploadImageText;

    const selectImageLabel = document.querySelector('label[for="imageInput"]');
    if (selectImageLabel) selectImageLabel.textContent = t.selectImage;

    const extractBtn = document.getElementById('startOcrBtn');
    if (extractBtn) extractBtn.textContent = t.extractSimplify;

    // Text paste section
    const textarea = document.querySelector('#tab-text textarea');
    if (textarea) textarea.placeholder = t.pasteHere;

    const simplifyTextBtn = document.querySelector('#textForm button[type="submit"]');
    if (simplifyTextBtn) simplifyTextBtn.textContent = t.simplifyText;

    // Features
    const features = document.querySelectorAll('.feature-item');
    if (features[0]) {
        features[0].querySelector('h3').textContent = t.securePrivate;
        features[0].querySelector('p').textContent = t.secureDesc;
    }
    if (features[1]) {
        features[1].querySelector('h3').textContent = t.interactiveAI;
        features[1].querySelector('p').textContent = t.interactiveDesc;
    }
    if (features[2]) {
        features[2].querySelector('h3').textContent = t.multilingual;
        features[2].querySelector('p').textContent = t.multilingualDesc;
    }

    // Footer
    const privacyLink = document.querySelector('.main-footer a');
    if (privacyLink) privacyLink.textContent = t.privacyPolicy;

    // Store preference
    localStorage.setItem('docdigest_lang', lang);
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    // Load saved language or default to English
    const savedLang = localStorage.getItem('docdigest_lang') || 'en';
    switchLanguage(savedLang);

    // Add click handlers to flags
    const flags = document.querySelectorAll('.flags-container img');
    const langMap = {
        'us': 'en',
        'es': 'es',
        'fr': 'fr',
        'de': 'de',
        'it': 'it',
        'cn': 'cn'
    };

    flags.forEach(flag => {
        flag.style.cursor = 'pointer';
        flag.style.transition = 'transform 0.2s ease';

        flag.addEventListener('click', () => {
            const alt = flag.alt.toLowerCase();
            const src = flag.src;
            const countryCode = src.match(/\/([a-z]{2})\.png/)[1];
            const lang = langMap[countryCode] || 'en';
            switchLanguage(lang);

            // Visual feedback
            flags.forEach(f => f.style.transform = 'scale(1)');
            flag.style.transform = 'scale(1.2)';
        });

        flag.addEventListener('mouseenter', () => {
            flag.style.transform = 'scale(1.15)';
        });

        flag.addEventListener('mouseleave', () => {
            const src = flag.src;
            const countryCode = src.match(/\/([a-z]{2})\.png/)[1];
            const lang = langMap[countryCode] || 'en';
            if (lang !== currentLang) {
                flag.style.transform = 'scale(1)';
            }
        });
    });
});
